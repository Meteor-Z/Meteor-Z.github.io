<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>事件传递与响应 | Meteor-Z个人播客</title><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><link href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/github.min.css rel=stylesheet></head><body><nav><ul class=menu><li><a href=/>Home</a></li><li><a href=/about/>关于</a></li><li><a href=/skill>技术笔记</a></li><li><a href=/posts/>随笔笔记</a></li><li><a href=/categories/>分类</a></li><li><a href=/tags/>标签</a></li><li><a href=/summarize/>资料整理</a></li><li><a href=/tips/>Tips</a></li><li><a href=/index.xml>订阅</a></li></ul><hr></nav><div class=article-meta><h1><span class=title>事件传递与响应</span></h1><h2 class=author>Meteor-Z</h2><h2 class=date>2025/07/21</h2><p class=terms>Categories: <a href=/categories/ios>iOS</a>
Tags: <a href=/tags/ios>iOS</a> <a href=/tags/%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92>事件传递</a></p></div><main><p>今天居然是0721诶</p><h2 id=第一响应者>第一响应者</h2><h2 id=事件传递的过程>事件传递的过程</h2><ol><li>触发事件后，系统会将该事件加入到一个由 UIApplication 管理的事件队列中；</li><li>UIApplication 会从事件队列中取出最前面的事件，将之分发出去以便处理，通常，先发送事件给应用程序的主窗口（ keyWindow ）；</li><li>主窗口会在视图层次结构中找到一个最适合的视图来处理触摸事件；</li><li>找到适合的视图控件后，就会调用该视图控件的 touches(_:with:) 方法；</li><li>touches(_:with:) 的默认实现是将事件顺着响应者链一直传递下去，直到连 UIApplication 对象也不能响应事件，则将其丢弃。</li></ol><h3 id=查找过程>查找过程</h3><p>iOS采用hit-test的形式进行遍历</p><ul><li>hit-test采用逆序深度遍历的方式找到最前面的视图，然后这个视图</li></ul><p><img src=./ResponderChain-hit-test-depth-first-traversal.png alt=传递过程></p><h2 id=响应者链>响应者链</h2><p>当事件发生之后，从触发事件的源头开始，按照一定的顺序对各个视图或者空间进行遍历处理，直到最终被处理或者被丢弃，</p><p>传递到下面后，然后往上开始回溯，找到第一个响应者，如果这个响应者不处理，就会通过nextResponder往上走，直到有事件响应。</p></main><footer><script src=//cdn.jsdelivr.net/combine/npm/katex/dist/katex.min.js,npm/katex/dist/contrib/auto-render.min.js,npm/@xiee/utils/js/render-katex.js defer></script>
<script src=//cdn.jsdelivr.net/npm/@xiee/utils/js/center-img.min.js defer></script>
<script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js></script>
<script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/languages/r.min.js></script>
<script>hljs.configure({languages:[]}),hljs.initHighlightingOnLoad()</script><hr><a href=/change-log>ChangeLog</a><br>© <a href=https://github.com/Meteor-Z>Liu Zechen</a> 2022 &ndash; 2025 | All rights reserved.</footer></body></html>